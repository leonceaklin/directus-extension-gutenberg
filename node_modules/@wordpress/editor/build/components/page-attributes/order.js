"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PageAttributesOrder = void 0;

var _element = require("@wordpress/element");

var _i18n = require("@wordpress/i18n");

var _components = require("@wordpress/components");

var _data = require("@wordpress/data");

var _compose = require("@wordpress/compose");

var _postTypeSupportCheck = _interopRequireDefault(require("../post-type-support-check"));

var _store = require("../../store");

/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */
const PageAttributesOrder = _ref => {
  let {
    onUpdateOrder,
    order = 0
  } = _ref;
  const [orderInput, setOrderInput] = (0, _element.useState)(null);

  const setUpdatedOrder = value => {
    var _value$trim;

    setOrderInput(value);
    const newOrder = Number(value);

    if (Number.isInteger(newOrder) && ((_value$trim = value.trim) === null || _value$trim === void 0 ? void 0 : _value$trim.call(value)) !== '') {
      onUpdateOrder(Number(value));
    }
  };

  const value = orderInput === null ? order : orderInput;
  return (0, _element.createElement)(_components.TextControl, {
    className: "editor-page-attributes__order",
    type: "number",
    label: (0, _i18n.__)('Order'),
    value: value,
    onChange: setUpdatedOrder,
    size: 6,
    onBlur: () => {
      setOrderInput(null);
    }
  });
};

exports.PageAttributesOrder = PageAttributesOrder;

function PageAttributesOrderWithChecks(props) {
  return (0, _element.createElement)(_postTypeSupportCheck.default, {
    supportKeys: "page-attributes"
  }, (0, _element.createElement)(PageAttributesOrder, props));
}

var _default = (0, _compose.compose)([(0, _data.withSelect)(select => {
  return {
    order: select(_store.store).getEditedPostAttribute('menu_order')
  };
}), (0, _data.withDispatch)(dispatch => ({
  onUpdateOrder(order) {
    dispatch(_store.store).editPost({
      menu_order: order
    });
  }

}))])(PageAttributesOrderWithChecks);

exports.default = _default;
//# sourceMappingURL=order.js.map