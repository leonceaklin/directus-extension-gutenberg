import { createElement } from "@wordpress/element";

/**
 * WordPress dependencies
 */
import { useRef, useEffect } from '@wordpress/element';
import { Spinner, SearchControl } from '@wordpress/components';
import { focus } from '@wordpress/dom';
import { __, sprintf } from '@wordpress/i18n';
/**
 * Internal dependencies
 */

import MediaList from './media-list';
import useDebouncedInput from '../hooks/use-debounced-input';
import { useMediaResults } from './hooks';
import InserterNoResults from '../no-results';
const INITIAL_MEDIA_ITEMS_PER_PAGE = 10;
export function MediaCategoryDialog(_ref) {
  let {
    rootClientId,
    onInsert,
    category
  } = _ref;
  const container = useRef();
  useEffect(() => {
    const timeout = setTimeout(() => {
      const [firstTabbable] = focus.tabbable.find(container.current);
      firstTabbable === null || firstTabbable === void 0 ? void 0 : firstTabbable.focus();
    });
    return () => clearTimeout(timeout);
  }, [category]);
  return createElement("div", {
    ref: container,
    className: "block-editor-inserter__media-dialog"
  }, createElement(MediaCategoryPanel, {
    rootClientId: rootClientId,
    onInsert: onInsert,
    category: category
  }));
}
export function MediaCategoryPanel(_ref2) {
  let {
    rootClientId,
    onInsert,
    category
  } = _ref2;
  const [search, setSearch, debouncedSearch] = useDebouncedInput();
  const mediaList = useMediaResults({
    per_page: !!debouncedSearch ? 20 : INITIAL_MEDIA_ITEMS_PER_PAGE,
    media_type: category.mediaType,
    search: debouncedSearch,
    orderBy: !!debouncedSearch ? 'relevance' : 'date'
  });
  const baseCssClass = 'block-editor-inserter__media-panel';
  return createElement("div", {
    className: baseCssClass
  }, createElement(SearchControl, {
    className: `${baseCssClass}-search`,
    onChange: setSearch,
    value: search,
    label: sprintf(
    /* translators: %s: Name of the media category(ex. 'images, videos'). */
    __('Search %s'), category.label.toLocaleLowerCase()),
    placeholder: sprintf(
    /* translators: %s: Name of the media category(ex. 'images, videos'). */
    __('Search %s'), category.label.toLocaleLowerCase())
  }), !mediaList && createElement("div", {
    className: `${baseCssClass}-spinner`
  }, createElement(Spinner, null)), Array.isArray(mediaList) && !mediaList.length && createElement(InserterNoResults, null), !!(mediaList !== null && mediaList !== void 0 && mediaList.length) && createElement(MediaList, {
    rootClientId: rootClientId,
    onClick: onInsert,
    mediaList: mediaList,
    mediaType: category.mediaType
  }));
}
//# sourceMappingURL=media-panel.js.map